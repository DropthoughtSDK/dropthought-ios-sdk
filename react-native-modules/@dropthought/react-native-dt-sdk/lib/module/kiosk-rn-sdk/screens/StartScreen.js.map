{"version":3,"sources":["StartScreen.js"],"names":["React","StartScreenLayout","PlaceholderImageTypes","PlaceholderScreen","i18n","useSurveyContext","fromAPIDateStrToJS","checkSurveyStatus","surveyState","surveyStartDate","surveyEndDate","imageType","ProgramExpired","ProgramScheduled","ProgramUnavailable","now","Date","StartScreen","props","onStart","survey","changeLanguage","state","surveyEndDateStr","surveyStartDateStr","onLanguageSelectHandler","useCallback","language","t"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SACEC,iBADF,EAEEC,qBAFF,EAGEC,iBAHF,EAIEC,IAJF,QAKO,8BALP;AAMA,SAASC,gBAAT,QAAiC,oBAAjC;AACA,SAASC,kBAAT,QAAmC,2BAAnC;AAEA;AACA;AACA;AACA;AACA;AACA;;AACA,MAAMC,iBAAiB,GAAG,CAACC,WAAD,EAAcC,eAAd,EAA+BC,aAA/B,KAAiD;AACzE,MAAIC,SAAJ;;AACA,UAAQH,WAAR;AACE,SAAK,QAAL;AACEG,MAAAA,SAAS,GAAG,IAAZ;AACA;;AACF,SAAK,SAAL;AACEA,MAAAA,SAAS,GAAGT,qBAAqB,CAACU,cAAlC;AACA;;AACF,SAAK,WAAL;AACED,MAAAA,SAAS,GAAGT,qBAAqB,CAACW,gBAAlC;AACA;;AACF,SAAK,QAAL;AACA;AACEF,MAAAA,SAAS,GAAGT,qBAAqB,CAACY,kBAAlC;AAZJ,GAFyE,CAgBzE;;;AACA,MAAI,CAACH,SAAL,EAAgB;AACd,UAAMI,GAAG,GAAG,IAAIC,IAAJ,EAAZ;;AACA,QAAID,GAAG,GAAGN,eAAV,EAA2B;AACzBE,MAAAA,SAAS,GAAGT,qBAAqB,CAACW,gBAAlC;AACD,KAFD,MAEO,IAAIE,GAAG,GAAGL,aAAV,EAAyB;AAC9BC,MAAAA,SAAS,GAAGT,qBAAqB,CAACU,cAAlC;AACD;AACF;;AACD,SAAOD,SAAP;AACD,CA1BD;AA4BA;AACA;AACA;AACA;;;AACA,MAAMM,WAAW,GAAIC,KAAD,IAAW;AAC7B,QAAM;AAAEC,IAAAA;AAAF,MAAcD,KAApB;AACA,QAAM;AAAEE,IAAAA,MAAF;AAAUC,IAAAA;AAAV,MAA6BhB,gBAAgB,EAAnD;AACA,QAAM;AACJiB,IAAAA,KAAK,EAAEd,WADH;AAEJE,IAAAA,aAAa,EAAEa,gBAFX;AAGJd,IAAAA,eAAe,EAAEe;AAHb,MAIFJ,MAJJ;AAKA,QAAMX,eAAe,GAAGH,kBAAkB,CAACkB,kBAAD,CAA1C;AACA,QAAMd,aAAa,GAAGJ,kBAAkB,CAACiB,gBAAD,CAAxC;AAEA,QAAME,uBAAuB,GAAGzB,KAAK,CAAC0B,WAAN,CAC7BC,QAAD,IAAc;AACZN,IAAAA,cAAc,CAACM,QAAD,CAAd;AACD,GAH6B,EAI9B,CAACN,cAAD,CAJ8B,CAAhC,CAX6B,CAkB7B;;AACA,QAAMV,SAAS,GAAGJ,iBAAiB,CACjCC,WADiC,EAEjCC,eAFiC,EAGjCC,aAHiC,CAAnC;;AAKA,MAAIC,SAAJ,EAAe;AACb;AACA,wBACE,oBAAC,iBAAD;AACE,MAAA,SAAS,EAAEA,SADb;AAEE,MAAA,OAAO,EAAEP,IAAI,CAACwB,CAAL,CAAO,kCAAP;AAFX,MADF;AAMD;;AAED,sBACE,oBAAC,iBAAD;AACE,IAAA,MAAM,EAAER,MADV;AAEE,IAAA,OAAO,EAAED,OAFX;AAGE,IAAA,gBAAgB,EAAEM;AAHpB,IADF;AAOD,CAzCD;;AA2CA,eAAeR,WAAf;AAEA;AACA;AACA;AACA","sourcesContent":["import React from 'react';\nimport {\n  StartScreenLayout,\n  PlaceholderImageTypes,\n  PlaceholderScreen,\n  i18n,\n} from '@dropthought/react-native-ui';\nimport { useSurveyContext } from '../contexts/survey';\nimport { fromAPIDateStrToJS } from '../../lib/DateTimerParser';\n\n/**\n *\n * @param {import('../../data').ProgramStateType} surveyState\n * @param {Date} surveyStartDate\n * @param {Date} surveyEndDate\n */\nconst checkSurveyStatus = (surveyState, surveyStartDate, surveyEndDate) => {\n  let imageType;\n  switch (surveyState) {\n    case 'active':\n      imageType = null;\n      break;\n    case 'expired':\n      imageType = PlaceholderImageTypes.ProgramExpired;\n      break;\n    case 'scheduled':\n      imageType = PlaceholderImageTypes.ProgramScheduled;\n      break;\n    case 'drafts':\n    default:\n      imageType = PlaceholderImageTypes.ProgramUnavailable;\n  }\n  // still need to check the start-end time\n  if (!imageType) {\n    const now = new Date();\n    if (now < surveyStartDate) {\n      imageType = PlaceholderImageTypes.ProgramScheduled;\n    } else if (now > surveyEndDate) {\n      imageType = PlaceholderImageTypes.ProgramExpired;\n    }\n  }\n  return imageType;\n};\n\n/**\n * @type {React.FunctionComponent<ScreenProps>}\n * @param {ScreenProps} props\n */\nconst StartScreen = (props) => {\n  const { onStart } = props;\n  const { survey, changeLanguage } = useSurveyContext();\n  const {\n    state: surveyState,\n    surveyEndDate: surveyEndDateStr,\n    surveyStartDate: surveyStartDateStr,\n  } = survey;\n  const surveyStartDate = fromAPIDateStrToJS(surveyStartDateStr);\n  const surveyEndDate = fromAPIDateStrToJS(surveyEndDateStr);\n\n  const onLanguageSelectHandler = React.useCallback(\n    (language) => {\n      changeLanguage(language);\n    },\n    [changeLanguage]\n  );\n\n  // render placeholder\n  const imageType = checkSurveyStatus(\n    surveyState,\n    surveyStartDate,\n    surveyEndDate\n  );\n  if (imageType) {\n    // need to render placeholder\n    return (\n      <PlaceholderScreen\n        imageType={imageType}\n        message={i18n.t('start-survey:placeholder-message')}\n      />\n    );\n  }\n\n  return (\n    <StartScreenLayout\n      survey={survey}\n      onStart={onStart}\n      onLanguageSelect={onLanguageSelectHandler}\n    />\n  );\n};\n\nexport default StartScreen;\n\n/**\n * @typedef {Object} ScreenProps\n * @property {() => void} onStart\n */\n"]}