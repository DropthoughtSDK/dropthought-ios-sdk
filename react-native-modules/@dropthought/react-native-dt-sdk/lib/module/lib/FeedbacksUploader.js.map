{"version":3,"names":["isEmpty","v4","uuidv4","apiPostEvent","QueueStorage","KEY_FEEDBACKS","KEY_FAILED_FEEDBACKS_DURING_PROCESSING","KEY_FAILED_REASONS_DURING_PROCESSING","FeedbacksQueue","key","encrypted","FailedFeedbacksQueue","FailedReasonsQueue","sendFeedback","surveyFeedback","programId","surveyId","feedbacks","metadata","createdTime","timeZone","UploaderStates","Idle","Processing","waitUntil","check","round","Promise","resolve","timeout","setTimeout","CreateFeedbacksUploader","initialized","state","numOfProcessed","userCanceled","subscriptions","publish","queuedFeedbacks","failedFeedbacksDuringProcessing","failedReasons","getAll","forEach","subscription","subscriber","uploadStatus","numOfFeedbacksProcessed","uploadSingle","feedback","front","err","_err$response","console","log","message","enqueue","status","response","dequeue","uploadDone","retryFailed","failedFeedbacks","clear","uploadStart","uploadContinue","cancel","all","initialize","undefined","upload","subscribe","id","push","removeSubscription","filter","sub","feedbackUploader"],"sourceRoot":"../../../src","sources":["lib/FeedbacksUploader.js"],"mappings":"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"}