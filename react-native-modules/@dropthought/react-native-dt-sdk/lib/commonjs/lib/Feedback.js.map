{"version":3,"sources":["Feedback.js"],"names":["submitFeedback","surveyFeedback","programId","surveyId","feedbacks","metadata","createdTime","timeZone","timeout","catch","error","saveFeedback","FeedbacksQueue","enqueue"],"mappings":";;;;;;;AAAA;;AACA;;AAEA;AACA;AACA;AACA;AACO,MAAMA,cAAc,GAAG,OAAO,CAACC,cAAD,CAAP,KAA4B;AACxD,SAAO,uBACL;AACEC,IAAAA,SAAS,EAAED,cAAc,CAACE,QAD5B;AAEEC,IAAAA,SAAS,EAAEH,cAAc,CAACG,SAF5B;AAGEC,IAAAA,QAAQ,EAAEJ,cAAc,CAACI,QAH3B;AAIEC,IAAAA,WAAW,EAAEL,cAAc,CAACK,WAJ9B;AAKEC,IAAAA,QAAQ,EAAEN,cAAc,CAACM;AAL3B,GADK,EAQL;AACE;AACAC,IAAAA,OAAO,EAAE;AAFX,GARK,EAYLC,KAZK,CAYEC,KAAD,IAAW;AACjB;AACA;AACAC,IAAAA,YAAY,CAACV,cAAD,CAAZ;AACA,UAAMS,KAAN;AACD,GAjBM,CAAP;AAkBD,CAnBM;AAqBP;AACA;AACA;;;;;AACO,MAAMC,YAAY,GAAG,MAAOV,cAAP,IAA0B;AACpD,SAAOW,kCAAeC,OAAf,CAAuBZ,cAAvB,CAAP;AACD,CAFM;AAIP;;AACA","sourcesContent":["import { apiPostEvent } from './API';\nimport { FeedbacksQueue } from './FeedbacksUploader';\n\n/**\n * the format is to fit in the react-async deferFn\n * @param {[SurveyFeedback]} surveyFeedback\n */\nexport const submitFeedback = async ([surveyFeedback]) => {\n  return apiPostEvent(\n    {\n      programId: surveyFeedback.surveyId,\n      feedbacks: surveyFeedback.feedbacks,\n      metadata: surveyFeedback.metadata,\n      createdTime: surveyFeedback.createdTime,\n      timeZone: surveyFeedback.timeZone,\n    },\n    {\n      // use shorter timeout here,\n      timeout: 10000,\n    }\n  ).catch((error) => {\n    // save result when there's error\n    // TODO: maybe there're some errors no need to be saved?\n    saveFeedback(surveyFeedback);\n    throw error;\n  });\n};\n\n/**\n * @param {SurveyFeedback} surveyFeedback\n */\nexport const saveFeedback = async (surveyFeedback) => {\n  return FeedbacksQueue.enqueue(surveyFeedback);\n};\n\n/**@typedef {import('../data').Feedback} Feedback */\n/**@typedef {import('../data').SurveyFeedback} SurveyFeedback */\n"]}